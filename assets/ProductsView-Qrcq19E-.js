import{i as N,r as y,j,k as z,l as D,o as F,a as L,b as a,c as o,e as l,d as t,w as b,m as u,F as m,q as v,t as i,v as E,f,x as g,p as H,g as U}from"./index-AP1mULAj.js";import{u as G}from"./toastMessage-hYlk33Q3.js";import{u as J}from"./cartStore-VmWaVlR-.js";import{P as K}from"./PaginationComponent-b-h3ghuo.js";import{H as Q}from"./HeroSection-70C6suYV.js";import{_ as W}from"./plugin-vueexport-helper-x3n3nnut.js";var X={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"vue001",BASE_URL:"/lightcraft/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const I=h=>(H("data-v-408fcb19"),h=h(),U(),h),Y={class:"products-view"},Z={class:"container mt-md-5 mt-3 mb-7"},ee={class:"row"},te={class:"col-lg-3 col-md-4"},se={class:"category-menu bg-light rounded p-4 mb-4"},ae=I(()=>t("h5",{class:"mb-3 fw-bold"},"💡 產品分類",-1)),oe={class:"list-unstyled"},ie={class:"mb-2"},ne={class:"col-lg-9 col-md-8"},re={class:"d-flex justify-content-between align-items-center mb-4"},ce={class:"mb-0"},le={class:"text-muted"},de={class:"row"},_e={class:"card border-0 shadow-sm h-100 product-card"},ue={class:"position-relative overflow-hidden"},me=["src"],fe={key:0,class:"discount-badge position-absolute bg-danger text-white px-2 py-1 rounded",style:{left:"12px",top:"12px","font-size":"0.75rem","font-weight":"bold"}},ge={class:"card-body p-3 d-flex flex-column"},he={class:"card-title mb-2 fw-bold"},pe={class:"product-specs mb-2 flex-grow-1"},ye={key:0,class:"badge bg-light text-dark me-1 mb-1"},be={key:1,class:"badge bg-secondary text-white me-1 mb-1"},ve={key:0,class:"card-text text-muted small mb-2"},xe={class:"price-section mb-3"},ke={class:"d-flex align-items-center"},we={class:"current-price h6 text-primary me-2 mb-0 fw-bold"},$e={key:0,class:"original-price text-muted text-decoration-line-through small"},Pe={key:1,class:"rating mb-3"},Ce={class:"d-flex align-items-center"},Se={class:"stars me-2"},Te={class:"text-muted small"},qe={key:2,class:"rating mb-3"},Ve={class:"d-flex align-items-center"},Le={class:"stars me-2"},Ee=I(()=>t("span",{class:"text-muted small"},"尚無評價",-1)),Ie=["onClick","disabled"],Me={key:0,class:"fas fa-spinner fa-spin me-1"},Re={key:1,class:"fas fa-shopping-cart me-1"},Ae={__name:"ProductsView",setup(h){const{VITE_APP_URL:P,VITE_APP_PATH:C}=X,p=N(),S=G(),M=J(),x=y([]),T=y([]),k=y(!0),d=y(null),w=j({total_pages:1,current_page:1,has_pre:!1,has_next:!1}),R=z(()=>p.query.category?`${p.query.category} 系列`:"全部商品"),q=s=>s?s.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):"",V=s=>({智慧吊燈:"fas fa-lightbulb",智慧檯燈:"fas fa-desk-lamp",智慧燈泡:"fas fa-lightbulb",智慧燈具:"fas fa-home",氣氛燈光:"fas fa-star",戶外照明:"fas fa-moon",燈光配件:"fas fa-cog",室內照明:"fas fa-home",裝飾燈具:"fas fa-star",特殊用途:"fas fa-tools",衣服:"fas fa-tshirt",蛋糕:"fas fa-birthday-cake",食物:"fas fa-utensils",飲品:"fas fa-coffee",電子產品:"fas fa-laptop",家電:"fas fa-tv",書籍:"fas fa-book",玩具:"fas fa-gamepad",運動用品:"fas fa-basketball-ball",美妝:"fas fa-palette"})[s]||"fas fa-lightbulb text-warning",A=async()=>{var s,r;try{const c=await E.get(`${P}/api/${C}/products/all`),n=[...new Set(c.data.products.map(e=>e.category))];T.value=n.filter(e=>e).map(e=>({name:e,icon:V(e)}))}catch(c){S.addMessage({title:"載入分類失敗",content:((r=(s=c.response)==null?void 0:s.data)==null?void 0:r.message)||"無法載入產品分類，請稍後再試",style:"danger"})}},$=async(s=1)=>{var c,n;const{category:r=""}=p.query;k.value=!0;try{const e=await E.get(`${P}/api/${C}/products?category=${r}&page=${s}`);x.value=e.data.products,Object.assign(w,e.data.pagination)}catch(e){S.addMessage({title:"載入產品失敗",content:((n=(c=e.response)==null?void 0:c.data)==null?void 0:n.message)||"無法載入產品列表，請稍後再試",style:"danger"})}finally{k.value=!1}},O=s=>{s<1||s>w.total_pages||($(s),window.scrollTo({top:0,behavior:"smooth"}))},B=async(s,r=1)=>{d.value=s;try{await M.addToCart(s,r)}finally{d.value=null}};return D(()=>p.query,()=>{$(1)}),F(()=>{A(),$()}),(s,r)=>{const c=L("LoadingOverlay"),n=L("RouterLink");return a(),o(m,null,[l(c,{active:k.value},null,8,["active"]),t("div",Y,[l(Q,{title:R.value,subtitle:"探索精選商品，發現生活中的美好","icon-class":"bi bi-basket3"},null,8,["title"]),t("div",Z,[t("div",ee,[t("div",te,[t("div",se,[ae,t("ul",oe,[t("li",ie,[l(n,{class:u(["category-link d-block py-2 px-3 rounded text-decoration-none",{"active bg-primary text-white":!s.$route.query.category,"text-dark":s.$route.query.category}]),to:"/products"},{default:b(()=>[f(" 🔍 全部商品 ")]),_:1},8,["class"])]),(a(!0),o(m,null,v(T.value,e=>(a(),o("li",{class:"mb-2",key:e.name},[l(n,{class:u(["category-link d-block py-2 px-3 rounded text-decoration-none",{"active bg-primary text-white":s.$route.query.category===e.name,"text-dark":s.$route.query.category!==e.name}]),to:`/products?category=${e.name}`},{default:b(()=>[t("i",{class:u([e.icon,"me-2"])},null,2),f(i(e.name),1)]),_:2},1032,["to","class"])]))),128))])])]),t("div",ne,[t("div",re,[t("h4",ce,i(s.$route.query.category?`${s.$route.query.category} 系列`:"全部商品"),1),t("span",le,"共 "+i(x.value.length)+" 件商品",1)]),t("div",de,[(a(!0),o(m,null,v(x.value,e=>(a(),o("div",{class:"col-xl-4 col-lg-6 col-md-6 mb-4",key:e.id},[t("div",_e,[t("div",ue,[l(n,{to:`/product/${e.id}`},{default:b(()=>[t("img",{src:e.imageUrl,class:"card-img-top product-image",height:"225",style:{"object-fit":"cover",transition:"transform 0.3s ease"},alt:"product.title"},null,8,me)]),_:2},1032,["to"]),e.origin_price>e.price?(a(),o("span",fe,i(Math.round((1-e.price/e.origin_price)*100))+"% OFF ",1)):g("",!0)]),t("div",ge,[t("h6",he,[l(n,{to:`/product/${e.id}`,class:"text-decoration-none text-dark"},{default:b(()=>[f(i(e.title),1)]),_:2},1032,["to"])]),t("div",pe,[e.category?(a(),o("span",ye,[t("i",{class:u([V(e.category),"me-1"])},null,2),f(" "+i(e.category),1)])):g("",!0),e.unit?(a(),o("span",be,i(e.unit),1)):g("",!0)]),e.description?(a(),o("p",ve,i(e.description.substring(0,50))+" "+i(e.description.length>50?"...":""),1)):g("",!0),t("div",xe,[t("div",ke,[t("span",we," NT$"+i(q(e.price)),1),e.origin_price>e.price?(a(),o("span",$e," NT$"+i(q(e.origin_price)),1)):g("",!0)])]),e.star&&e.star>0?(a(),o("div",Pe,[t("div",Ce,[t("div",Se,[(a(),o(m,null,v(5,_=>t("i",{key:_,class:u(_<=e.star?"fas fa-star text-warning":"far fa-star text-muted"),style:{"font-size":"0.8rem"}},null,2)),64))]),t("span",Te,i(e.star)+".0 顆星",1)])])):(a(),o("div",qe,[t("div",Ve,[t("div",Le,[(a(),o(m,null,v(5,_=>t("i",{key:_,class:"far fa-star text-muted",style:{"font-size":"0.8rem"}})),64))]),Ee])])),t("button",{class:"btn btn-outline-primary btn-sm w-100 mt-auto",onClick:_=>B(e.id),disabled:d.value===e.id},[d.value===e.id?(a(),o("i",Me)):(a(),o("i",Re)),f(" "+i(d.value===e.id?"加入中...":"加入購物車"),1)],8,Ie)])])]))),128))]),l(K,{pagination:w,"aria-label":"產品分頁",onChangePage:O},null,8,["pagination"])])])])])],64)}}},Fe=W(Ae,[["__scopeId","data-v-408fcb19"]]);export{Fe as default};
