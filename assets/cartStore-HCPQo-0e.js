import{s as i,g as n}from"./index-5uWLd9w3.js";import{u as r}from"./toastMessage-OX34INNF.js";var l={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"ryanpro",BASE_URL:"/vue_practise_w7/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_URL:c,VITE_APP_PATH:d}=l,h=i("cart",{state:()=>({carts:[],final_total:0,total:0}),actions:{getCart(){const a=r();n.get(`${c}/api/${d}/cart`).then(t=>{console.log("購物車 API 回應:",t.data);const{carts:e,total:s,final_total:o}=t.data.data;this.carts=e,this.total=s,e.length>0&&e[0].coupon?this.final_total=Math.round(o):this.final_total=Math.round(this.total)}).catch(t=>{a.addMessage({title:"錯誤",content:t.response.data.message,style:"danger"})})},addToCart(a){const t=r(),e={product_id:a,qty:1};n.post(`${c}/api/${d}/cart`,{data:e}).then(s=>{t.addMessage({title:"成功",content:s.data.message,style:"success"}),this.getCart()}).catch(s=>{t.addMessage({title:"錯誤",content:s.response.data.message,style:"danger"})})},async applyCoupon(a){var e,s;const t=r();try{const o=await n.post(`${c}/api/${d}/coupon`,{data:{code:a}});return t.addMessage({title:"成功",content:o.data.message,style:"success"}),this.getCart(),o}catch(o){throw t.addMessage({title:"錯誤",content:((s=(e=o.response)==null?void 0:e.data)==null?void 0:s.message)||"套用優惠券失敗",style:"danger"}),o}},updateCartItem(a){const t=r(),e={product_id:a.product_id,qty:a.qty};return n.put(`${c}/api/${d}/cart/${a.id}`,{data:e}).then(s=>(t.addMessage({title:"成功",content:s.data.message,style:"success"}),this.getCart(),s)).catch(s=>{throw t.addMessage({title:"錯誤",content:s.response.data.message,style:"danger"}),s})},removeCartItem(a){const t=r();return n.delete(`${c}/api/${d}/cart/${a}`).then(e=>(t.addMessage({title:"成功",content:e.data.message,style:"success"}),this.getCart(),e)).catch(e=>{throw t.addMessage({title:"錯誤",content:e.response.data.message,style:"danger"}),e})},clearCart(){const a=r();return n.delete(`${c}/api/${d}/carts`).then(t=>(a.addMessage({title:"成功",content:t.data.message,style:"success"}),this.getCart(),t)).catch(t=>{throw a.addMessage({title:"錯誤",content:t.response.data.message,style:"danger"}),t})}}});export{h as u};
