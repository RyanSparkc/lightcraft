import{_ as h,m as p,a as _,o as u,c as v,b as s,C as a,D as d,n,t as l,G as b,p as g,f as S}from"./index-Z_5okpXm.js";import{u as f}from"./cartStore-ew9kN5wG.js";import"./toastMessage-fwkowjpF.js";const y={name:"CheckoutAddress",data(){return{form:{name:"",email:"",phone:"",address:"",message:""},errors:{},shippingFee:"NT$ 0",estimatedDelivery:"3–5 個工作天",isSubmitting:!1}},computed:{...p(f,["carts","total","final_total"])},methods:{..._(f,["createOrder"]),validate(){return this.errors={},this.form.name||(this.errors.name="姓名為必填"),this.form.email?/^[\w.-]+@([\w-]+\.)+[\w-]{2,4}$/.test(this.form.email)||(this.errors.email="Email格式不正確"):this.errors.email="Email為必填",this.form.phone?/^[0-9]+$/.test(this.form.phone)||(this.errors.phone="手機格式需為數字"):this.errors.phone="手機為必填",this.form.address||(this.errors.address="地址為必填"),Object.keys(this.errors).length===0},async nextStep(){if(this.validate()&&!this.isSubmitting){this.isSubmitting=!0;try{const r={carts:this.carts,total:this.total,final_total:this.final_total};localStorage.setItem("orderCartData",JSON.stringify(r));const o={user:{name:this.form.name,email:this.form.email,tel:this.form.phone,address:this.form.address},message:this.form.message||""},m=await this.createOrder(o);localStorage.removeItem("checkoutAddress"),this.$router.push(`/checkout/payment?orderId=${m.orderId}`)}catch{}finally{this.isSubmitting=!1}}},loadAddressData(){const r=localStorage.getItem("checkoutAddress");r&&(this.form=JSON.parse(r))}},mounted(){this.loadAddressData()}},i=r=>(g("data-v-e1d5f320"),r=r(),S(),r),x={class:"container my-5"},k=i(()=>s("h2",{class:"section-title mb-4"},"寄送資訊",-1)),D={class:"row"},w={class:"col-md-8"},I={class:"form-card mb-4"},A={class:"form-group mb-3"},C=i(()=>s("label",{for:"name",class:"form-label"},"姓名",-1)),V={class:"invalid-feedback"},O={class:"form-group mb-3"},U=i(()=>s("label",{for:"email",class:"form-label"},"Email",-1)),q={class:"invalid-feedback"},E={class:"form-group mb-3"},N=i(()=>s("label",{for:"phone",class:"form-label"},"手機",-1)),B={class:"invalid-feedback"},F={class:"form-group mb-3"},J=i(()=>s("label",{for:"address",class:"form-label"},"地址",-1)),M={class:"invalid-feedback"},T={class:"form-group mb-3"},j=i(()=>s("label",{for:"message",class:"form-label"},"訂單備註",-1)),z=i(()=>s("small",{class:"form-text text-muted"}," 如有特殊需求或配送說明，請在此填寫 ",-1)),G={class:"col-md-4"},H={class:"info-card"},K=i(()=>s("h3",{class:"card-title"},"配送資訊",-1)),L={class:"info-item"},P=i(()=>s("div",{class:"info-label"},"運費",-1)),Q={class:"info-value"},R={class:"info-item"},W=i(()=>s("div",{class:"info-label"},"預估到貨時間",-1)),X={class:"info-value"},Y={class:"text-end mt-4"},Z=["disabled"];function $(r,o,m,ss,e,c){return u(),v("div",x,[k,s("form",{onSubmit:o[5]||(o[5]=b((...t)=>c.nextStep&&c.nextStep(...t),["prevent"]))},[s("div",D,[s("div",w,[s("div",I,[s("div",A,[C,a(s("input",{type:"text",id:"name","onUpdate:modelValue":o[0]||(o[0]=t=>e.form.name=t),class:n(["form-control",{"is-invalid":e.errors.name}]),required:"",placeholder:"請輸入收件人姓名"},null,2),[[d,e.form.name]]),s("div",V,l(e.errors.name),1)]),s("div",O,[U,a(s("input",{type:"email",id:"email","onUpdate:modelValue":o[1]||(o[1]=t=>e.form.email=t),class:n(["form-control",{"is-invalid":e.errors.email}]),required:"",placeholder:"example@email.com"},null,2),[[d,e.form.email]]),s("div",q,l(e.errors.email),1)]),s("div",E,[N,a(s("input",{type:"text",id:"phone","onUpdate:modelValue":o[2]||(o[2]=t=>e.form.phone=t),class:n(["form-control",{"is-invalid":e.errors.phone}]),required:"",pattern:"^[0-9]+$",placeholder:"請輸入手機號碼"},null,2),[[d,e.form.phone]]),s("div",B,l(e.errors.phone),1)]),s("div",F,[J,a(s("input",{type:"text",id:"address","onUpdate:modelValue":o[3]||(o[3]=t=>e.form.address=t),class:n(["form-control",{"is-invalid":e.errors.address}]),required:"",placeholder:"請輸入詳細地址"},null,2),[[d,e.form.address]]),s("div",M,l(e.errors.address),1)]),s("div",T,[j,a(s("textarea",{id:"message","onUpdate:modelValue":o[4]||(o[4]=t=>e.form.message=t),class:"form-control",rows:"3",placeholder:"請輸入訂單備註（選填）"},null,512),[[d,e.form.message]]),z])])]),s("div",G,[s("div",H,[K,s("div",L,[P,s("div",Q,l(e.shippingFee),1)]),s("div",R,[W,s("div",X,l(e.estimatedDelivery),1)])])])]),s("div",Y,[s("button",{type:"submit",class:"btn-primary",disabled:e.isSubmitting},l(e.isSubmitting?"建立訂單中...":"建立訂單並前往付款"),9,Z)])],32)])}const rs=h(y,[["render",$],["__scopeId","data-v-e1d5f320"]]);export{rs as default};
