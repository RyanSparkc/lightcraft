import{_ as k,R as x,E as I,a as y,r as S,o as n,c as i,b as t,F as L,i as q,C as g,D as f,t as d,j as b,d as h,w as p,e as r,n as C,p as N,f as T}from"./index-Z_5okpXm.js";import{u as v}from"./cartStore-ew9kN5wG.js";import{u as w}from"./toastMessage-fwkowjpF.js";const j={components:{RouterLink:x},data(){return{loadingItem:"",isClearing:!1,couponCode:"",isApplyingCoupon:!1}},computed:{...I(v,w),showCoupon(){var e,c;return!!((c=(e=this.cartStore)==null?void 0:e.carts[0])!=null&&c.coupon)},discountAmount(){const e=this.cartStore.total-this.cartStore.final_total;return console.log("total",this.cartStore.total),Math.round(e)}},methods:{...y(v,["getCart","updateCartItem","removeCartItem","clearCart","applyCoupon"]),...y(w,["addMessage"]),formatPrice(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},async updateCartItemLocal(e){this.loadingItem=e.id;try{await this.updateCartItem(e)}catch{}finally{this.loadingItem=""}},updateQuantity(e,c){if(c>=1&&c<=20){const m={...e,qty:c};this.updateCartItemLocal(m)}},async removeCartItemLocal(e){this.loadingItem=e;try{await this.removeCartItem(e)}catch{}finally{this.loadingItem=""}},async clearCartLocal(){this.isClearing=!0;try{await this.clearCart()}catch{}finally{this.isClearing=!1}},async applyCouponLocal(){if(!this.couponCode){this.addMessage({title:"提示",content:"請輸入優惠碼",style:"warning"});return}this.isApplyingCoupon=!0;try{await this.applyCoupon(this.couponCode),this.couponCode=""}catch{}finally{this.isApplyingCoupon=!1}}},mounted(){this.getCart()}},a=e=>(N("data-v-116ec9ad"),e=e(),T(),e),A={class:"container my-5"},V=a(()=>t("h2",{class:"section-title mb-4"},"購物車",-1)),P={key:0},M={class:"table-responsive"},B={class:"table align-middle"},R=a(()=>t("thead",{class:"bg-light"},[t("tr",null,[t("th",{class:"py-3"},"商品資訊"),t("th",{class:"py-3 text-center",style:{width:"180px"}},"數量"),t("th",{class:"py-3 text-end"},"單價"),t("th",{class:"py-3 text-end"},"小計"),t("th",{class:"py-3 text-center"},"操作")])],-1)),U={class:"d-flex align-items-center"},D={class:"me-3",style:{width:"80px",height:"80px"}},E=["src","alt"],F={class:"mb-1"},z={class:"text-muted"},Q={key:0,class:"badge bg-success mt-1"},G={class:"quantity-selector-wrapper d-flex justify-content-center"},H={class:"quantity-selector d-flex"},J=["onClick","disabled"],K=a(()=>t("i",{class:"bi bi-dash"},null,-1)),O=[K],W=["onUpdate:modelValue","onChange","disabled"],X=["onClick","disabled"],Y=a(()=>t("i",{class:"bi bi-plus"},null,-1)),Z=[Y],$={class:"text-end"},tt={class:"fw-medium"},st={key:0,class:"text-muted text-decoration-line-through small"},et={class:"text-end fw-bold"},ot={class:"text-center"},at=["onClick","disabled"],ct={key:0,class:"bi bi-arrow-clockwise spinner-icon"},nt={key:1,class:"bi bi-trash"},it=a(()=>t("span",{class:"ms-1 d-none d-sm-inline"},"刪除",-1)),lt={class:"card mt-4 border-0 shadow-sm"},dt={class:"card-body p-4"},rt={class:"row"},ut={class:"col-md-6 d-flex align-items-center mb-md-0 mb-3"},_t=["disabled"],ht=["disabled"],pt={key:0,class:"bi bi-arrow-clockwise spinner-icon"},bt={key:1},mt={class:"col-md-6"},yt={class:"d-flex justify-content-between align-items-center mb-2"},gt=a(()=>t("span",{class:"text-muted"},"商品小計：",-1)),ft=a(()=>t("div",{class:"d-flex justify-content-between align-items-center mb-2"},[t("span",{class:"text-muted"},"運費："),t("span",null,"NT$ 0")],-1)),Ct={key:0,class:"d-flex justify-content-between align-items-center mb-2"},vt=a(()=>t("span",{class:"text-muted"},"已套用優惠券：",-1)),wt={class:"fw-bold text-success"},kt={key:1,class:"d-flex justify-content-between align-items-center mb-2"},xt=a(()=>t("span",{class:"text-muted"},"折扣金額：",-1)),It={class:"fw-bold text-success"},St=a(()=>t("hr",null,null,-1)),Lt={class:"d-flex justify-content-between align-items-center mb-0"},qt=a(()=>t("span",{class:"fs-5 fw-bold"},"總計金額：",-1)),Nt={class:"fs-5 fw-bold text-danger"},Tt={class:"cart-actions mt-4"},jt={class:"d-md-flex justify-content-between align-items-center"},At=a(()=>t("i",{class:"bi bi-arrow-left me-2"},null,-1)),Vt=["disabled"],Pt={key:0,class:"bi bi-arrow-clockwise spinner-icon"},Mt={key:1,class:"bi bi-trash me-1"},Bt=a(()=>t("i",{class:"bi bi-arrow-right ms-2"},null,-1)),Rt={class:"d-md-none"},Ut={class:"row g-2 mb-2"},Dt={class:"col-6"},Et=a(()=>t("i",{class:"bi bi-arrow-left me-2"},null,-1)),Ft={class:"col-6"},zt=a(()=>t("i",{class:"bi bi-arrow-right ms-2"},null,-1)),Qt={class:"row"},Gt={class:"col-12"},Ht=["disabled"],Jt={key:0,class:"bi bi-arrow-clockwise spinner-icon"},Kt={key:1,class:"bi bi-trash me-1"},Ot={key:1,class:"text-center py-5 my-4"},Wt=a(()=>t("div",{class:"mb-4"},[t("i",{class:"bi bi-cart fs-1 text-muted"})],-1)),Xt=a(()=>t("h4",{class:"mb-3"},"購物車目前沒有任何商品",-1)),Yt=a(()=>t("p",{class:"text-muted mb-4"},"快去商城挑選您喜愛的商品吧！",-1)),Zt=a(()=>t("i",{class:"bi bi-bag me-2"},null,-1));function $t(e,c,m,ts,l,o){const u=S("RouterLink");return n(),i("div",A,[V,e.cartStore.carts&&e.cartStore.carts.length>0?(n(),i("div",P,[t("div",M,[t("table",B,[R,t("tbody",null,[(n(!0),i(L,null,q(e.cartStore.carts,s=>(n(),i("tr",{key:s.id,class:"border-bottom"},[t("td",null,[t("div",U,[t("div",D,[t("img",{src:s.product.imageUrl,alt:s.product.title,class:"img-fluid rounded object-fit-cover",style:{width:"100%",height:"100%"}},null,8,E)]),t("div",null,[t("h6",F,d(s.product.title),1),t("small",z,d(s.product.category),1),s.coupon_code?(n(),i("div",Q," 已套用優惠券 ")):b("",!0)])])]),t("td",null,[t("div",G,[t("div",H,[t("button",{class:"qty-btn qty-btn-minus",onClick:_=>o.updateQuantity(s,s.qty-1),disabled:l.loadingItem===s.id||s.qty<=1},O,8,J),g(t("input",{type:"number",class:"qty-input text-center","onUpdate:modelValue":_=>s.qty=_,min:"1",max:"20",onChange:_=>o.updateCartItemLocal(s),disabled:l.loadingItem===s.id},null,40,W),[[f,s.qty,void 0,{number:!0}]]),t("button",{class:"qty-btn qty-btn-plus",onClick:_=>o.updateQuantity(s,s.qty+1),disabled:l.loadingItem===s.id||s.qty>=20},Z,8,X)])])]),t("td",$,[t("span",tt,"NT$ "+d(o.formatPrice(s.product.price)),1),s.product.origin_price>s.product.price?(n(),i("div",st," NT$ "+d(o.formatPrice(s.product.origin_price)),1)):b("",!0)]),t("td",et," NT$ "+d(o.formatPrice(s.total)),1),t("td",ot,[t("button",{type:"button",class:"btn-danger-outline",onClick:_=>o.removeCartItemLocal(s.id),disabled:l.loadingItem===s.id},[l.loadingItem===s.id?(n(),i("i",ct)):(n(),i("i",nt)),it],8,at)])]))),128))])])]),t("div",lt,[t("div",dt,[t("div",rt,[t("div",ut,[g(t("input",{type:"text",class:"form-control coupon-input me-2",placeholder:"請輸入優惠碼","onUpdate:modelValue":c[0]||(c[0]=s=>l.couponCode=s),disabled:l.isApplyingCoupon},null,8,_t),[[f,l.couponCode]]),t("button",{class:"btn-apply",onClick:c[1]||(c[1]=(...s)=>o.applyCouponLocal&&o.applyCouponLocal(...s)),disabled:l.isApplyingCoupon||!l.couponCode},[l.isApplyingCoupon?(n(),i("i",pt)):(n(),i("span",bt,"套用"))],8,ht)]),t("div",mt,[t("div",yt,[gt,t("span",null,"NT$ "+d(o.formatPrice(e.cartStore.total)),1)]),ft,o.showCoupon?(n(),i("div",Ct,[vt,t("span",wt,d(e.cartStore.carts[0].coupon.code),1)])):b("",!0),o.showCoupon?(n(),i("div",kt,[xt,t("span",It," 折扣 NT$ "+d(o.formatPrice(o.discountAmount)),1)])):b("",!0),St,t("div",Lt,[qt,t("span",Nt," NT$ "+d(o.formatPrice(e.cartStore.final_total)),1)])])])])]),t("div",Tt,[t("div",jt,[h(u,{to:"/products",class:"btn-secondary"},{default:p(()=>[At,r("繼續購物 ")]),_:1}),t("button",{type:"button",class:"btn-danger-outline",onClick:c[2]||(c[2]=(...s)=>o.clearCartLocal&&o.clearCartLocal(...s)),disabled:e.cartStore.carts.length===0||l.isClearing},[l.isClearing?(n(),i("i",Pt)):(n(),i("i",Mt)),r(" 清空購物車 ")],8,Vt),h(u,{to:"/checkout/address",class:C(["btn-primary",{disabled:e.cartStore.carts.length===0}])},{default:p(()=>[r(" 前往結帳 "),Bt]),_:1},8,["class"])]),t("div",Rt,[t("div",Ut,[t("div",Dt,[h(u,{to:"/products",class:"btn-secondary w-100"},{default:p(()=>[Et,r("繼續購物 ")]),_:1})]),t("div",Ft,[h(u,{to:"/checkout/address",class:C(["btn-primary w-100",{disabled:e.cartStore.carts.length===0}])},{default:p(()=>[r(" 前往結帳 "),zt]),_:1},8,["class"])])]),t("div",Qt,[t("div",Gt,[t("button",{type:"button",class:"btn-danger-outline w-100",onClick:c[3]||(c[3]=(...s)=>o.clearCartLocal&&o.clearCartLocal(...s)),disabled:e.cartStore.carts.length===0||l.isClearing},[l.isClearing?(n(),i("i",Jt)):(n(),i("i",Kt)),r(" 清空購物車 ")],8,Ht)])])])])])):(n(),i("div",Ot,[Wt,Xt,Yt,h(u,{to:"/products",class:"btn-primary"},{default:p(()=>[Zt,r("瀏覽商品 ")]),_:1})]))])}const as=k(j,[["render",$t],["__scopeId","data-v-116ec9ad"]]);export{as as default};
