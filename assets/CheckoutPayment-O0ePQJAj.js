import{_ as h,m as p,a as u,o as l,c as n,b as t,C as v,H as _,F as b,i as f,t as i,j as y,g as c,p as C,f as S}from"./index-A2IetPGn.js";import{u as m}from"./cartStore-qI79ORR3.js";import"./toastMessage-rb2ZDsSZ.js";const g={name:"CheckoutPayment",data(){return{selectedPayment:"credit",isSubmitting:!1,termsAccepted:!0,orderId:null,orderCartData:{carts:[],total:0,final_total:0}}},computed:{...p(m,["carts","total","final_total"]),displayCarts(){return this.orderCartData.carts.length>0?this.orderCartData.carts:this.carts},displayTotal(){return this.orderCartData.total>0?this.orderCartData.total:this.total},displayFinalTotal(){return this.orderCartData.final_total>0?this.orderCartData.final_total:this.final_total},formattedTotal(){return Math.round(this.displayTotal).toLocaleString()},formattedFinalTotal(){return Math.round(this.displayFinalTotal).toLocaleString()},discountAmount(){return Math.round(this.displayTotal-this.displayFinalTotal)},hasDiscount(){return this.discountAmount>0}},methods:{...u(m,["getCart","createOrder","payOrder"]),async completeOrder(){if(!this.isSubmitting)try{if(this.isSubmitting=!0,!this.orderId){this.$router.push("/checkout/address");return}await this.payOrder(this.orderId),localStorage.removeItem("orderCartData"),this.$router.push(`/checkout/complete/${this.orderId}`)}catch{}finally{this.isSubmitting=!1}}},mounted(){this.getCart(),this.orderId=this.$route.query.orderId;const s=localStorage.getItem("orderCartData");s&&(this.orderCartData=JSON.parse(s)),this.orderId||this.$router.push("/checkout/address")}},e=s=>(C("data-v-463b6236"),s=s(),S(),s),k={class:"container my-5"},T=e(()=>t("h2",{class:"section-title mb-4"},"付款方式",-1)),D={class:"row"},I={class:"col-md-8"},N={class:"form-card mb-4"},F=e(()=>t("h3",{class:"payment-subtitle mb-3"},"選擇付款方式",-1)),L={class:"payment-options"},O={class:"payment-option"},$=e(()=>t("label",{for:"credit",class:"payment-label"},[t("span",{class:"payment-name"},"信用卡付款"),t("span",{class:"payment-desc"},"Visa, Mastercard, JCB")],-1)),A=c('<div class="payment-option" data-v-463b6236><input type="radio" id="transfer" name="payment" value="transfer" class="payment-radio" data-v-463b6236><label for="transfer" class="payment-label" data-v-463b6236><span class="payment-name" data-v-463b6236>銀行轉帳</span><span class="payment-desc" data-v-463b6236>收到款項後才出貨</span></label></div><div class="payment-option" data-v-463b6236><input type="radio" id="atm" name="payment" value="atm" class="payment-radio" data-v-463b6236><label for="atm" class="payment-label" data-v-463b6236><span class="payment-name" data-v-463b6236>ATM 轉帳</span><span class="payment-desc" data-v-463b6236>收到款項確認後才出貨</span></label></div>',2),M=e(()=>t("div",{class:"security-info mt-3 mb-4"},[t("div",{class:"d-flex align-items-center"},[t("i",{class:"bi bi-shield-lock me-2"}),t("span",null,"本站使用 SSL 加密技術，保障您的交易安全")])],-1)),w={class:"col-md-4"},x={class:"info-card"},P=e(()=>t("h3",{class:"card-title"},"訂單資訊",-1)),V={class:"order-items mb-3"},q=e(()=>t("h4",{class:"items-subtitle mb-2"},"訂購商品",-1)),B={class:"item-info"},j={class:"item-name"},J={class:"item-details"},E={class:"item-qty"},H={class:"item-price"},R={class:"item-total"},U={class:"info-item"},z=e(()=>t("div",{class:"info-label"},"商品總額",-1)),G={class:"info-value"},K=c('<div class="info-item" data-v-463b6236><div class="info-label" data-v-463b6236>運費</div><div class="info-value" data-v-463b6236>NT$ 0</div></div><div class="info-item" data-v-463b6236><div class="info-label" data-v-463b6236>稅金</div><div class="info-value" data-v-463b6236>NT$ 0</div></div>',2),Q={key:0,class:"info-item discount"},W=e(()=>t("div",{class:"info-label"},"優惠折扣",-1)),X={class:"info-value"},Y={class:"info-item total"},Z=e(()=>t("div",{class:"info-label"},"總計",-1)),tt={class:"info-value"},at=c('<div class="terms-section mt-3" data-v-463b6236><div class="form-check" data-v-463b6236><input class="form-check-input" type="checkbox" id="terms" checked data-v-463b6236><label class="form-check-label" for="terms" data-v-463b6236> 我已閱讀並同意<a href="#" class="terms-link" data-v-463b6236>服務條款</a>與<a href="#" class="terms-link" data-v-463b6236>隱私政策</a></label></div></div>',1),st={class:"d-flex justify-content-between mt-4"},et=["disabled"];function it(s,d,ot,dt,r,o){return l(),n("div",k,[T,t("div",D,[t("div",I,[t("div",N,[F,t("div",L,[t("div",O,[v(t("input",{type:"radio",id:"credit",name:"payment",value:"credit","onUpdate:modelValue":d[0]||(d[0]=a=>r.selectedPayment=a),class:"payment-radio"},null,512),[[_,r.selectedPayment]]),$]),A])]),M]),t("div",w,[t("div",x,[P,t("div",V,[q,(l(!0),n(b,null,f(o.displayCarts,a=>(l(),n("div",{class:"order-item",key:a.id},[t("div",B,[t("div",j,i(a.product.title),1),t("div",J,[t("span",E,"數量: "+i(a.qty),1),t("span",H,"NT$ "+i(a.product.price.toLocaleString()),1)])]),t("div",R," NT$ "+i((a.product.price*a.qty).toLocaleString()),1)]))),128))]),t("div",U,[z,t("div",G,"NT$ "+i(o.formattedTotal),1)]),K,o.hasDiscount?(l(),n("div",Q,[W,t("div",X," -NT$ "+i(o.discountAmount.toLocaleString()),1)])):y("",!0),t("div",Y,[Z,t("div",tt,"NT$ "+i(o.formattedFinalTotal),1)]),at])])]),t("div",st,[t("button",{class:"btn-secondary",onClick:d[1]||(d[1]=a=>s.$router.back())},"上一步"),t("button",{class:"btn-primary",onClick:d[2]||(d[2]=(...a)=>o.completeOrder&&o.completeOrder(...a)),disabled:r.isSubmitting},i(r.isSubmitting?"處理中...":"確認付款並送出訂單"),9,et)])])}const ct=h(g,[["render",it],["__scopeId","data-v-463b6236"]]);export{ct as default};
