import{i as M,H as B,r as T,k as _,o as U,b as i,c as n,d as t,f as V,t as c,m as A,x as h,F,q as H,h as W,v as J,p as G,g as K}from"./index-AP1mULAj.js";import{_ as Q}from"./plugin-vueexport-helper-x3n3nnut.js";var X={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"vue001",BASE_URL:"/lightcraft/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const e=p=>(G("data-v-8a355579"),p=p(),K(),p),Y={class:"order-detail-container container my-5"},Z={class:"mb-4"},tt=e(()=>t("i",{class:"bi bi-arrow-left me-2"},null,-1)),st={key:0,class:"card mb-4"},et={class:"card-body"},at={class:"d-flex justify-content-between align-items-center mb-3"},ot={class:"card-title mb-0"},ct={class:"row mt-3"},it={class:"col-md-6"},nt=e(()=>t("p",{class:"text-muted mb-1"},"訂單日期",-1)),dt={class:"mb-3"},lt={class:"col-md-6"},rt=e(()=>t("p",{class:"text-muted mb-1"},"付款日期",-1)),_t={class:"mb-3"},ut={class:"col-md-6"},ht=e(()=>t("p",{class:"text-muted mb-1"},"配送狀態",-1)),vt={class:"mb-3"},mt={class:"badge bg-secondary"},pt={class:"col-md-6"},bt=e(()=>t("p",{class:"text-muted mb-1"},"付款方式",-1)),gt={class:"mb-3"},ft={key:0,class:"mt-3 pt-3 border-top"},yt=e(()=>t("i",{class:"bi bi-credit-card me-2"},null,-1)),xt={key:1,class:"card mb-4"},kt=e(()=>t("div",{class:"card-header bg-white border-bottom-0 py-3"},[t("h5",{class:"mb-0"},"配送追蹤")],-1)),wt={class:"card-body"},Tt=e(()=>t("div",{class:"mb-3"},[t("p",{class:"text-muted mb-1"},"物流單號"),t("p",{class:"mb-0 fw-medium"},"TW123456789")],-1)),Nt={class:"tracking-timeline-horizontal"},Pt={class:"tracking-item-horizontal active"},zt=e(()=>t("div",{class:"tracking-icon-horizontal"},[t("i",{class:"bi bi-check-circle-fill"})],-1)),St={class:"tracking-content-horizontal"},$t=e(()=>t("p",{class:"tracking-title"},"訂單已確認",-1)),Vt={class:"tracking-date"},At=e(()=>t("div",{class:"tracking-icon-horizontal"},[t("i",{class:"bi bi-credit-card"})],-1)),It={class:"tracking-content-horizontal"},Et=e(()=>t("p",{class:"tracking-title"},"付款完成",-1)),jt={class:"tracking-date"},Dt=W('<div class="tracking-item-horizontal" data-v-8a355579><div class="tracking-icon-horizontal" data-v-8a355579><i class="bi bi-box-seam" data-v-8a355579></i></div><div class="tracking-content-horizontal" data-v-8a355579><p class="tracking-title" data-v-8a355579>商品已出貨</p><p class="tracking-date" data-v-8a355579>待處理</p></div></div><div class="tracking-item-horizontal" data-v-8a355579><div class="tracking-icon-horizontal" data-v-8a355579><i class="bi bi-house-door" data-v-8a355579></i></div><div class="tracking-content-horizontal" data-v-8a355579><p class="tracking-title" data-v-8a355579>商品已送達</p><p class="tracking-date" data-v-8a355579>待處理</p></div></div>',2),Lt={key:2,class:"row"},Ot={class:"col-lg-8 mb-4"},qt={class:"card h-100"},Ct=e(()=>t("div",{class:"card-header bg-white border-bottom-0 py-3"},[t("h5",{class:"mb-0"},"訂單商品")],-1)),Rt={class:"card-body"},Mt={class:"table-responsive"},Bt={class:"table mb-0"},Ut=e(()=>t("thead",{class:"table-light"},[t("tr",null,[t("th",{class:"border-0"},"商品"),t("th",{class:"border-0 text-center"},"單價"),t("th",{class:"border-0 text-center"},"數量"),t("th",{class:"border-0 text-end"},"小計")])],-1)),Ft={class:"d-flex align-items-center"},Ht=["src"],Wt={class:"mb-0"},Jt={class:"text-muted"},Gt={class:"text-center align-middle"},Kt={class:"text-center align-middle"},Qt={class:"text-end align-middle"},Xt={class:"col-lg-4"},Yt={class:"card mb-4"},Zt=e(()=>t("div",{class:"card-header bg-white border-bottom-0 py-3"},[t("h5",{class:"mb-0"},"收件人資訊")],-1)),ts={class:"card-body"},ss={class:"mb-3"},es=e(()=>t("p",{class:"text-muted mb-1"},"姓名",-1)),as={class:"mb-0 fw-medium"},os={class:"mb-3"},cs=e(()=>t("p",{class:"text-muted mb-1"},"電話",-1)),is={class:"mb-0 fw-medium"},ns={class:"mb-3"},ds=e(()=>t("p",{class:"text-muted mb-1"},"Email",-1)),ls={class:"mb-0 fw-medium"},rs=e(()=>t("p",{class:"text-muted mb-1"},"地址",-1)),_s={class:"mb-0 fw-medium"},us={class:"card"},hs=e(()=>t("div",{class:"card-header bg-white border-bottom-0 py-3"},[t("h5",{class:"mb-0"},"金額摘要")],-1)),vs={class:"card-body"},ms={class:"d-flex justify-content-between mb-2"},ps=e(()=>t("span",null,"商品總額",-1)),bs=e(()=>t("div",{class:"d-flex justify-content-between mb-2"},[t("span",null,"運費"),t("span",null,"NT$ 0")],-1)),gs={key:0,class:"d-flex justify-content-between mb-3"},fs=e(()=>t("span",null,"優惠折扣",-1)),ys={class:"text-danger"},xs=e(()=>t("hr",null,null,-1)),ks={class:"d-flex justify-content-between"},ws=e(()=>t("span",{class:"fw-bold"},"總計",-1)),Ts={class:"fw-bold"},Ns={key:3,class:"text-center py-5"},Ps=e(()=>t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),zs=e(()=>t("p",{class:"mt-3"},"正在獲取訂單資料...",-1)),Ss=[Ps,zs],$s={key:4,class:"text-center py-5"},Vs=e(()=>t("h4",null,"找不到訂單資料",-1)),As=e(()=>t("p",{class:"text-muted"},"請確認訂單號碼是否正確",-1)),Is={__name:"OrderDetailView",setup(p){const I=M(),E=B(),a=T({}),b=T(!1),j=T({credit_card:"信用卡",credit:"信用卡",atm:"ATM 轉帳",transfer:"銀行轉帳",bank_transfer:"銀行轉帳"}),x=_(()=>a.value&&a.value.id),v=_(()=>a.value.products?Object.values(a.value.products):[]),k=_(()=>v.value.length?v.value.reduce((s,o)=>{var d;const r=Number((d=o.product)==null?void 0:d.price)||0,u=Number(o.qty)||0;return s+r*u},0):0),g=_(()=>v.value.length?v.value.reduce((s,o)=>{const r=Number(o.final_total)||0;return s+r},0):0),N=_(()=>{const s=k.value-g.value;return s>0?s:0}),w=_(()=>N.value>0),D=_(()=>w.value?N.value:g.value),L=_(()=>w.value?g.value:0),O=async s=>{var u;if(!s)return;const{VITE_APP_URL:o,VITE_APP_PATH:r}=X;b.value=!0;try{const d=`${o}/api/${r}/order/${s}`,y=await J.get(d);a.value=y.data.order}catch(d){((u=d.response)==null?void 0:u.status)===404&&(a.value=null)}finally{b.value=!1}},f=s=>s?new Date(s*1e3).toLocaleString("zh-TW",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"無資料",m=s=>{const o=Number(s);return!o||Number.isNaN(o)?"0":Math.round(o).toLocaleString()};function q(s){return s.is_paid?"備貨中":"待付款"}function C(s){return s!=null&&s.payment_method?j.value[s.payment_method]||"其他方式":"未設定"}const R=()=>{const s={carts:v.value.map(o=>({id:o.id,product:o.product,qty:o.qty})),total:k.value,final_total:g.value};localStorage.setItem("orderCartData",JSON.stringify(s)),E.push({path:"/checkout/payment",query:{orderId:a.value.id}})};return U(()=>{const s=I.params.id;s&&O(s)}),(s,o)=>{var r,u,d,y;return i(),n("div",Y,[t("div",Z,[t("button",{class:"btn btn-outline-secondary",onClick:o[0]||(o[0]=l=>s.$router.go(-1))},[tt,V("返回 ")])]),x.value?(i(),n("div",st,[t("div",et,[t("div",at,[t("h4",ot,"訂單 #"+c(a.value.id||"123456"),1),t("span",{class:A(["order-status px-3 py-1 rounded-pill flex-shrink-0",{"bg-success text-white":a.value.is_paid,"bg-warning":!a.value.is_paid}])},c(a.value.is_paid?"已付款":"待付款"),3)]),t("div",ct,[t("div",it,[nt,t("p",dt,c(f(a.value.create_at)),1)]),t("div",lt,[rt,t("p",_t,c(a.value.paid_date?f(a.value.paid_date):"尚未付款"),1)]),t("div",ut,[ht,t("p",vt,[t("span",mt,c(q(a.value)),1)])]),t("div",pt,[bt,t("p",gt,c(C(a.value)),1)])]),a.value.is_paid?h("",!0):(i(),n("div",ft,[t("div",{class:"d-flex justify-content-end"},[t("button",{class:"btn btn-warning btn-lg px-4 payment-btn",onClick:R},[yt,V(" 前往付款 ")])])]))])])):h("",!0),x.value?(i(),n("div",xt,[kt,t("div",wt,[Tt,t("div",Nt,[t("div",Pt,[zt,t("div",St,[$t,t("p",Vt,c(f(a.value.create_at)),1)])]),t("div",{class:A(["tracking-item-horizontal",{active:a.value.is_paid}])},[At,t("div",It,[Et,t("p",jt,c(a.value.paid_date?f(a.value.paid_date):"待處理"),1)])],2),Dt])])])):h("",!0),x.value?(i(),n("div",Lt,[t("div",Ot,[t("div",qt,[Ct,t("div",Rt,[t("div",Mt,[t("table",Bt,[Ut,t("tbody",null,[(i(!0),n(F,null,H(v.value,l=>{var P,z,S,$;return i(),n("tr",{key:l.id},[t("td",null,[t("div",Ft,[t("img",{src:(P=l.product)==null?void 0:P.imageUrl,class:"img-fluid me-3",style:{width:"60px",height:"60px","object-fit":"cover"},alt:"商品圖片"},null,8,Ht),t("div",null,[t("h6",Wt,c((z=l.product)==null?void 0:z.title),1),t("small",Jt,c((S=l.product)==null?void 0:S.category),1)])])]),t("td",Gt," NT$ "+c(m(($=l.product)==null?void 0:$.price)),1),t("td",Kt,c(l.qty),1),t("td",Qt," NT$ "+c(m(l.final_total)),1)])}),128))])])])])])]),t("div",Xt,[t("div",Yt,[Zt,t("div",ts,[t("div",ss,[es,t("p",as,c((r=a.value.user)==null?void 0:r.name),1)]),t("div",os,[cs,t("p",is,c((u=a.value.user)==null?void 0:u.tel),1)]),t("div",ns,[ds,t("p",ls,c((d=a.value.user)==null?void 0:d.email),1)]),t("div",null,[rs,t("p",_s,c((y=a.value.user)==null?void 0:y.address),1)])])]),t("div",us,[hs,t("div",vs,[t("div",ms,[ps,t("span",null,"NT$ "+c(m(k.value)),1)]),bs,w.value?(i(),n("div",gs,[fs,t("span",ys,"-NT$ "+c(m(L.value)),1)])):h("",!0),xs,t("div",ks,[ws,t("span",Ts,"NT$ "+c(m(D.value)),1)])])])])])):h("",!0),b.value?(i(),n("div",Ns,Ss)):h("",!0),!b.value&&(!a.value||!a.value.id)?(i(),n("div",$s,[Vs,As,t("button",{class:"btn btn-primary mt-3",onClick:o[1]||(o[1]=l=>s.$router.push("/"))}," 返回首頁 ")])):h("",!0)])}}},Ds=Q(Is,[["__scopeId","data-v-8a355579"]]);export{Ds as default};
