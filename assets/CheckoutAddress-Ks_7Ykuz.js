import{H as w,s as D,j as f,r as p,o as A,b as E,c as O,d as e,E as n,G as c,m as _,t as d,I as V,p as C,g as U}from"./index-AP1mULAj.js";import{u as $}from"./cartStore-VmWaVlR-.js";import{_ as j}from"./plugin-vueexport-helper-x3n3nnut.js";import"./toastMessage-hYlk33Q3.js";const l=m=>(C("data-v-20a960b6"),m=m(),U(),m),q={class:"container my-5"},N=l(()=>e("h2",{class:"section-title mb-4"},"寄送資訊",-1)),T={class:"row"},B={class:"col-md-8"},M={class:"form-card mb-4"},J={class:"form-group mb-3"},R=l(()=>e("label",{for:"name",class:"form-label"},"姓名",-1)),z={class:"invalid-feedback"},F={class:"form-group mb-3"},G=l(()=>e("label",{for:"email",class:"form-label"},"Email",-1)),H={class:"invalid-feedback"},K={class:"form-group mb-3"},L=l(()=>e("label",{for:"phone",class:"form-label"},"手機",-1)),P={class:"invalid-feedback"},Q={class:"form-group mb-3"},W=l(()=>e("label",{for:"address",class:"form-label"},"地址",-1)),X={class:"invalid-feedback"},Y={class:"form-group mb-3"},Z=l(()=>e("label",{for:"message",class:"form-label"},"訂單備註",-1)),ee=l(()=>e("small",{class:"form-text text-muted"}," 如有特殊需求或配送說明，請在此填寫 ",-1)),se={class:"col-md-4"},te={class:"info-card"},oe=l(()=>e("h3",{class:"card-title"},"配送資訊",-1)),ae={class:"info-item"},le=l(()=>e("div",{class:"info-label"},"運費",-1)),ie={class:"info-value"},de={class:"info-item"},re=l(()=>e("div",{class:"info-label"},"預估到貨時間",-1)),ne={class:"info-value"},ce={class:"text-end mt-4"},me=["disabled"],_e={__name:"CheckoutAddress",setup(m){const h=w(),u=$(),{carts:v,total:b,final_total:g}=D(u),s=f({name:"",email:"",phone:"",address:"",message:""}),t=f({}),y=p("NT$ 0"),S=p("3–5 個工作天"),r=p(!1),k=()=>(Object.keys(t).forEach(i=>{delete t[i]}),s.name||(t.name="姓名為必填"),s.email?/^[\w.-]+@([\w-]+\.)+[\w-]{2,4}$/.test(s.email)||(t.email="Email格式不正確"):t.email="Email為必填",s.phone?/^[0-9]+$/.test(s.phone)||(t.phone="手機格式需為數字"):t.phone="手機為必填",s.address||(t.address="地址為必填"),Object.keys(t).length===0),x=async()=>{if(k()&&!r.value){r.value=!0;try{const i={carts:v.value,total:b.value,final_total:g.value};localStorage.setItem("orderCartData",JSON.stringify(i));const o={user:{name:s.name,email:s.email,tel:s.phone,address:s.address},message:s.message||""},a=await u.createOrder(o);localStorage.removeItem("checkoutAddress"),h.push(`/checkout/payment?orderId=${a.orderId}`)}catch{}finally{r.value=!1}}},I=()=>{const i=localStorage.getItem("checkoutAddress");if(i){const o=JSON.parse(i);Object.assign(s,o)}};return A(()=>{I()}),(i,o)=>(E(),O("div",q,[N,e("form",{onSubmit:V(x,["prevent"])},[e("div",T,[e("div",B,[e("div",M,[e("div",J,[R,n(e("input",{type:"text",id:"name","onUpdate:modelValue":o[0]||(o[0]=a=>s.name=a),class:_(["form-control",{"is-invalid":t.name}]),required:"",placeholder:"請輸入收件人姓名"},null,2),[[c,s.name]]),e("div",z,d(t.name),1)]),e("div",F,[G,n(e("input",{type:"email",id:"email","onUpdate:modelValue":o[1]||(o[1]=a=>s.email=a),class:_(["form-control",{"is-invalid":t.email}]),required:"",placeholder:"example@email.com"},null,2),[[c,s.email]]),e("div",H,d(t.email),1)]),e("div",K,[L,n(e("input",{type:"text",id:"phone","onUpdate:modelValue":o[2]||(o[2]=a=>s.phone=a),class:_(["form-control",{"is-invalid":t.phone}]),required:"",pattern:"^[0-9]+$",placeholder:"請輸入手機號碼"},null,2),[[c,s.phone]]),e("div",P,d(t.phone),1)]),e("div",Q,[W,n(e("input",{type:"text",id:"address","onUpdate:modelValue":o[3]||(o[3]=a=>s.address=a),class:_(["form-control",{"is-invalid":t.address}]),required:"",placeholder:"請輸入詳細地址"},null,2),[[c,s.address]]),e("div",X,d(t.address),1)]),e("div",Y,[Z,n(e("textarea",{id:"message","onUpdate:modelValue":o[4]||(o[4]=a=>s.message=a),class:"form-control",rows:"3",placeholder:"請輸入訂單備註（選填）"},null,512),[[c,s.message]]),ee])])]),e("div",se,[e("div",te,[oe,e("div",ae,[le,e("div",ie,d(y.value),1)]),e("div",de,[re,e("div",ne,d(S.value),1)])])])]),e("div",ce,[e("button",{type:"submit",class:"btn-primary",disabled:r.value},d(r.value?"建立訂單中...":"建立訂單並前往付款"),9,me)])],32)]))}},ve=j(_e,[["__scopeId","data-v-20a960b6"]]);export{ve as default};
