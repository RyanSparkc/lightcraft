import{r as h,j as H,l as q,b as n,c,d as e,E as u,G as _,f as R,x as F,F as E,q as z,m as N,P as W,t as b,S as X,v as L,p as G,g as J,o as Y,a as Z,e as S,U as ee}from"./index-AP1mULAj.js";import{u as K}from"./toastMessage-hYlk33Q3.js";import{u as se,_ as te,P as oe}from"./DeleteModal-Bg24l3Dc.js";import{_ as Q}from"./plugin-vueexport-helper-x3n3nnut.js";import{P as ae}from"./PaginationComponent-b-h3ghuo.js";var le={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"vue001",BASE_URL:"/lightcraft/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const i=f=>(G("data-v-e9bdbe83"),f=f(),J(),f),ie={class:"modal-dialog modal-xl"},ne={class:"modal-content border-0"},ce={class:"modal-header bg-dark text-white"},de={id:"productModalLabel",class:"modal-title"},re={key:0},ue={key:1},pe=i(()=>e("button",{type:"button",class:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close"},null,-1)),_e={class:"modal-body"},me={class:"row"},fe={class:"col-sm-4"},be={class:"mb-2"},ve={class:"mb-3"},he=i(()=>e("label",{for:"imageUrl",class:"form-label"},"主要圖片網址",-1)),ge={class:"mb-3"},ye={for:"customFile",class:"form-label"},Ue={key:0,class:"fas fa-spinner fa-spin"},$e=["src"],xe=i(()=>e("h3",null,"新增多圖",-1)),Pe={key:0},we={class:"mb-2"},ke=i(()=>e("label",{for:"imageUrl",class:"form-label"},"圖片網址",-1)),Ve=["onUpdate:modelValue"],Me=["src"],Ce={key:0},Ae={key:1},Se={key:1},Ee={class:"col-sm-8"},Te={class:"mb-3"},Ie=i(()=>e("label",{for:"title",class:"form-label"},"標題",-1)),Re={class:"row"},Le={class:"mb-3 col-md-6"},ze=i(()=>e("label",{for:"category",class:"form-label"},"分類",-1)),De={class:"mb-3 col-md-6"},Oe=i(()=>e("label",{for:"unit",class:"form-label"},"單位",-1)),Fe={class:"row"},Ne={class:"mb-3 col-md-6"},je=i(()=>e("label",{for:"origin_price",class:"form-label"},"原價",-1)),Be={class:"mb-3 col-md-6"},He=i(()=>e("label",{for:"price",class:"form-label"},"售價",-1)),qe={class:"mb-3"},Ge=i(()=>e("label",{class:"form-label"},"⭐ 產品評分",-1)),Je={class:"star-rating-selector"},Ke={class:"d-flex align-items-center"},Qe={class:"stars me-3"},We=["onClick","onMouseover"],Xe={class:"text-muted"},Ye=i(()=>e("small",{class:"text-muted d-block mt-1"}," 點擊星星設定評分，或點擊「清除」移除評分 ",-1)),Ze={class:"mb-3"},es=i(()=>e("label",{class:"form-label"},"📦 產品規格",-1)),ss={class:"specifications-editor border rounded p-3",style:{"background-color":"#f8f9fa"}},ts={class:"row"},os={class:"col-md-6 mb-3"},as=i(()=>e("label",{for:"spec-size",class:"form-label"},"尺寸",-1)),ls={class:"col-md-6 mb-3"},is=i(()=>e("label",{for:"spec-weight",class:"form-label"},"重量",-1)),ns={class:"row"},cs={class:"col-md-6 mb-3"},ds=i(()=>e("label",{for:"spec-material",class:"form-label"},"材質",-1)),rs={class:"col-md-6 mb-3"},us=i(()=>e("label",{for:"spec-color",class:"form-label"},"顏色",-1)),ps={class:"row"},_s={class:"col-md-6 mb-0"},ms=i(()=>e("label",{for:"spec-origin",class:"form-label"},"產地",-1)),fs=i(()=>e("small",{class:"text-muted d-block mt-2"}," 💡 產品規格將顯示在商品詳細頁面，幫助顧客了解產品特色 ",-1)),bs=i(()=>e("hr",null,null,-1)),vs={class:"mb-3"},hs=i(()=>e("label",{for:"description",class:"form-label"},"產品描述",-1)),gs={class:"mb-3"},ys=i(()=>e("label",{for:"content",class:"form-label"},"說明內容",-1)),Us={class:"mb-3"},$s={class:"form-check"},xs=i(()=>e("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1)),Ps={class:"modal-footer"},ws=i(()=>e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1)),ks={__name:"ProductModal",props:{tempProduct:{type:Object,default:()=>({})},isNew:{type:Boolean,default:!1}},emits:["update","update-product"],setup(f,{expose:$,emit:x}){const{VITE_APP_URL:V,VITE_APP_PATH:P}=le,v=f,w=x,m=K(),{modalRef:k,openModal:M,closeModal:D}=se(),g=h(null),U=H({fileUploading:!1}),s=H({imageUrl:"",imagesUrl:[],title:"",category:"",unit:"",origin_price:0,price:0,description:"",content:"",is_enabled:1,specifications:{size:"",weight:"",material:"",color:"",origin:""},star:0}),C=h(!0),A=h(0),O=l=>{s.star=l},d=()=>{s.star=0},r=()=>{s.imagesUrl=[""]},y=()=>{const l=g.value.files[0],t=new FormData;t.append("file-to-upload",l);const o=`${V}/api/${P}/admin/upload`;U.fileUploading=!0,L.post(o,t,{headers:{"Content-Type":"multipart/form-data"}}).then(p=>{U.fileUploading=!1,s.imageUrl=p.data.imageUrl,g.value.value="",C.value=!1,m.addMessage({title:"圖片上傳結果",content:p.data.message,style:"success"})}).catch(p=>{U.fileUploading=!1,m.addMessage({title:"圖片上傳結果",content:p.response.data.message,style:"danger"})})},a=l=>{Object.keys(s).forEach(t=>{t==="specifications"?s.specifications={size:"",weight:"",material:"",color:"",origin:""}:t==="imagesUrl"?s.imagesUrl=[]:t==="star"?s.star=0:typeof s[t]=="number"?s[t]=0:typeof s[t]=="string"?s[t]="":s[t]=null}),l&&typeof l=="object"&&Object.keys(l).forEach(t=>{var o,p,I,j,B;t==="specifications"?s.specifications={size:((o=l.specifications)==null?void 0:o.size)||"",weight:((p=l.specifications)==null?void 0:p.weight)||"",material:((I=l.specifications)==null?void 0:I.material)||"",color:((j=l.specifications)==null?void 0:j.color)||"",origin:((B=l.specifications)==null?void 0:B.origin)||""}:t==="imagesUrl"?s.imagesUrl=Array.isArray(l.imagesUrl)?[...l.imagesUrl]:[]:s[t]=l[t]}),s.specifications||(s.specifications={size:"",weight:"",material:"",color:"",origin:""}),typeof s.star>"u"&&(s.star=0),Array.isArray(s.imagesUrl)||(s.imagesUrl=[]),s.imagesUrl.length||s.imagesUrl.push("")};return q(()=>v.tempProduct,l=>{l&&a(l)},{immediate:!0,deep:!0}),q(()=>v.tempProduct,l=>{l&&a(l)},{immediate:!0,deep:!0}),$({openModal:M,closeModal:D}),(l,t)=>(n(),c("div",{id:"productModal",ref_key:"modalRef",ref:k,class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"},[e("div",ie,[e("div",ne,[e("div",ce,[e("h5",de,[f.isNew?(n(),c("span",re,"新增產品")):(n(),c("span",ue,"編輯產品"))]),pe]),e("div",_e,[e("div",me,[e("div",fe,[e("div",be,[e("div",ve,[he,u(e("input",{type:"text",class:"form-control",placeholder:"主要圖片連結","onUpdate:modelValue":t[0]||(t[0]=o=>s.imageUrl=o)},null,512),[[_,s.imageUrl]])]),e("div",ge,[e("label",ye,[R("或 上傳圖片 "),U.fileUploading?(n(),c("i",Ue)):F("",!0)]),e("input",{type:"file",id:"customFile",class:"form-control",ref_key:"fileInputRef",ref:g,onChange:y},null,544)]),e("img",{class:"img-fluid",src:s.imageUrl,alt:""},null,8,$e)]),xe,Array.isArray(s.imagesUrl)?(n(),c("div",Pe,[(n(!0),c(E,null,z(s.imagesUrl,(o,p)=>(n(),c("div",{class:"mb-3",key:p},[e("div",we,[ke,u(e("input",{type:"text",class:"form-control",placeholder:"圖片連結","onUpdate:modelValue":I=>s.imagesUrl[p]=I},null,8,Ve),[[_,s.imagesUrl[p]]])]),e("img",{class:"img-fluid",src:o,alt:""},null,8,Me)]))),128)),!s.imagesUrl.length||s.imagesUrl[s.imagesUrl.length-1]?(n(),c("div",Ce,[e("button",{class:"btn btn-outline-primary btn-sm d-block w-100",onClick:t[1]||(t[1]=o=>s.imagesUrl.push(""))}," 新增圖片 ")])):(n(),c("div",Ae,[e("button",{class:"btn btn-outline-danger btn-sm d-block w-100",onClick:t[2]||(t[2]=o=>s.imagesUrl.pop())}," 刪除圖片 ")]))])):(n(),c("div",Se,[e("button",{class:"btn btn-outline-primary btn-sm d-block w-100",onClick:r}," 新增圖片 ")]))]),e("div",Ee,[e("div",Te,[Ie,u(e("input",{id:"title",type:"text",class:"form-control",placeholder:"請輸入標題","onUpdate:modelValue":t[3]||(t[3]=o=>s.title=o)},null,512),[[_,s.title]])]),e("div",Re,[e("div",Le,[ze,u(e("input",{id:"category",type:"text",class:"form-control",placeholder:"請輸入分類","onUpdate:modelValue":t[4]||(t[4]=o=>s.category=o)},null,512),[[_,s.category]])]),e("div",De,[Oe,u(e("input",{id:"unit",type:"text",class:"form-control",placeholder:"請輸入單位","onUpdate:modelValue":t[5]||(t[5]=o=>s.unit=o)},null,512),[[_,s.unit]])])]),e("div",Fe,[e("div",Ne,[je,u(e("input",{id:"origin_price",type:"number",min:"0",class:"form-control",placeholder:"請輸入原價","onUpdate:modelValue":t[6]||(t[6]=o=>s.origin_price=o)},null,512),[[_,s.origin_price,void 0,{number:!0}]])]),e("div",Be,[He,u(e("input",{id:"price",type:"number",min:"0",class:"form-control",placeholder:"請輸入售價","onUpdate:modelValue":t[7]||(t[7]=o=>s.price=o)},null,512),[[_,s.price,void 0,{number:!0}]])])]),e("div",qe,[Ge,e("div",Je,[e("div",Ke,[e("div",Qe,[(n(),c(E,null,z(5,o=>e("i",{key:o,class:N([o<=(s.star||0)?"fas fa-star text-warning":"far fa-star text-muted","star-clickable"]),onClick:p=>O(o),onMouseover:p=>A.value=o,onMouseleave:t[8]||(t[8]=p=>A.value=0),style:W({fontSize:"1.5rem",cursor:"pointer",color:A.value>=o||o<=(s.star||0)?"#ffc107":"#6c757d"})},null,46,We)),64))]),e("span",Xe,b(s.star||0)+" / 5 星 ",1),e("button",{type:"button",class:"btn btn-outline-secondary btn-sm ms-2",onClick:d,title:"清除評分"}," 清除 ")]),Ye])]),e("div",Ze,[es,e("div",ss,[e("div",ts,[e("div",os,[as,u(e("input",{id:"spec-size",type:"text",class:"form-control",placeholder:"請輸入產品尺寸（長 x 寬 x 高）","onUpdate:modelValue":t[9]||(t[9]=o=>s.specifications.size=o)},null,512),[[_,s.specifications.size]])]),e("div",ls,[is,u(e("input",{id:"spec-weight",type:"text",class:"form-control",placeholder:"請輸入產品重量","onUpdate:modelValue":t[10]||(t[10]=o=>s.specifications.weight=o)},null,512),[[_,s.specifications.weight]])])]),e("div",ns,[e("div",cs,[ds,u(e("input",{id:"spec-material",type:"text",class:"form-control",placeholder:"請輸入產品材質","onUpdate:modelValue":t[11]||(t[11]=o=>s.specifications.material=o)},null,512),[[_,s.specifications.material]])]),e("div",rs,[us,u(e("input",{id:"spec-color",type:"text",class:"form-control",placeholder:"請輸入可選顏色（多種請用逗號分隔）","onUpdate:modelValue":t[12]||(t[12]=o=>s.specifications.color=o)},null,512),[[_,s.specifications.color]])])]),e("div",ps,[e("div",_s,[ms,u(e("input",{id:"spec-origin",type:"text",class:"form-control",placeholder:"請輸入產品產地","onUpdate:modelValue":t[13]||(t[13]=o=>s.specifications.origin=o)},null,512),[[_,s.specifications.origin]])])]),fs])]),bs,e("div",vs,[hs,u(e("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入產品描述","onUpdate:modelValue":t[14]||(t[14]=o=>s.description=o)},`
                `,512),[[_,s.description]])]),e("div",gs,[ys,u(e("textarea",{id:"content",type:"text",class:"form-control",placeholder:"請輸入說明內容","onUpdate:modelValue":t[15]||(t[15]=o=>s.content=o)},`
                `,512),[[_,s.content]])]),e("div",Us,[e("div",$s,[u(e("input",{id:"is_enabled",class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":t[16]||(t[16]=o=>s.is_enabled=o)},null,512),[[X,s.is_enabled]]),xs])])])])]),e("div",Ps,[ws,e("button",{type:"button",class:"btn btn-primary",onClick:t[17]||(t[17]=o=>w("update-product",s))}," 確認 ")])])])],512))}},Vs=Q(ks,[["__scopeId","data-v-e9bdbe83"]]);var Ms={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"vue001",BASE_URL:"/lightcraft/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const T=f=>(G("data-v-bb37157a"),f=f(),J(),f),Cs={class:"page-actions"},As={class:"actions-left"},Ss={class:"d-flex align-items-center gap-3"},Es={class:"text-muted"},Ts=T(()=>e("span",{class:"text-muted"},"|",-1)),Is={class:"text-muted"},Rs={class:"actions-right"},Ls=T(()=>e("i",{class:"fas fa-plus"},null,-1)),zs={class:"products-grid"},Ds={class:"product-card-header"},Os={class:"product-category"},Fs={class:"product-title"},Ns={class:"product-card-body"},js={class:"price-section"},Bs={key:0,class:"price-original"},Hs={class:"price-current"},qs={key:1,class:"price-discount"},Gs={class:"rating-section"},Js={key:0,class:"modern-rating"},Ks={class:"stars"},Qs={class:"rating-value"},Ws={key:1,class:"modern-rating"},Xs=T(()=>e("span",{class:"rating-text"},"尚未評分",-1)),Ys=[Xs],Zs={class:"status-section"},et={class:"product-card-actions"},st=["onClick"],tt=T(()=>e("i",{class:"fas fa-edit me-1"},null,-1)),ot=["onClick"],at=T(()=>e("i",{class:"fas fa-trash me-1"},null,-1)),lt={class:"d-flex justify-content-center"},it={__name:"ProductsView",setup(f){const{VITE_APP_URL:$,VITE_APP_PATH:x}=Ms,V=h([]),P=h(!1),v=h({imagesUrl:[]}),w=h({}),m=h(!1),k=h(null),M=h(null),D=K(),{addMessage:g}=D,U=d=>ee(d),s=async(d=1)=>{m.value=!0;try{const r=await L.get(`${$}/api/${x}/admin/products?page=${d}`),{products:y,pagination:a}=r.data;V.value=y,w.value=a,m.value=!1}catch(r){m.value=!1,g({title:"取得產品資訊失敗",content:r.response.data.message,style:"danger"})}},C=(d,r)=>{d==="new"?(v.value={imagesUrl:[]},P.value=!0,k.value.openModal()):d==="edit"?(v.value={...r},P.value=!1,k.value.openModal()):d==="delete"&&(v.value={...r},M.value.openModal())},A=async d=>{m.value=!0;let r=`${$}/api/${x}/admin/product/${v.value.id}`,y="put";P.value&&(r=`${$}/api/${x}/admin/product`,y="post");try{const a=await L[y](r,{data:d});m.value=!1,s(),k.value.closeModal(),g({title:"成功更新產品",content:a.data.message,style:"success"})}catch(a){m.value=!1,g({title:"更新產品失敗",content:a.response.data.message,style:"danger"})}},O=async()=>{m.value=!0;try{const d=`${$}/api/${x}/admin/product/${v.value.id}`,r=await L.delete(d);m.value=!1,s(),M.value.closeModal(),g({title:"成功刪除產品",content:r.data.message,style:"success"})}catch(d){m.value=!1,g({title:"刪除產品失敗",content:d.response.data.message,style:"danger"})}};return Y(()=>{s()}),(d,r)=>{const y=Z("LoadingOverlay");return n(),c(E,null,[S(y,{active:m.value},null,8,["active"]),S(oe,{icon:"fas fa-cube","icon-color":"text-primary",title:"產品列表",subtitle:"管理您的產品資訊，編輯商品詳情與價格設定"}),e("div",Cs,[e("div",As,[e("div",Ss,[e("span",Es,"共 "+b(V.value.length)+" 項產品",1),Ts,e("span",Is,"第 "+b(w.value.current_page||1)+" 頁，共 "+b(w.value.total_pages||1)+" 頁",1)])]),e("div",Rs,[e("button",{class:"btn-modern btn-primary-modern",onClick:r[0]||(r[0]=a=>C("new"))},[Ls,R(" 建立新產品 ")])])]),e("div",zs,[(n(!0),c(E,null,z(V.value,a=>(n(),c("div",{key:a.id,class:"product-card"},[e("div",Ds,[e("span",Os,b(a.category),1),e("h3",Fs,b(a.title),1)]),e("div",Ns,[e("div",js,[a.origin_price!==a.price?(n(),c("span",Bs," NT$ "+b(U(a.origin_price)),1)):F("",!0),e("span",Hs,"NT$ "+b(U(a.price)),1),a.origin_price!==a.price?(n(),c("span",qs,b(Math.round((1-a.price/a.origin_price)*100))+"% OFF ",1)):F("",!0)]),e("div",Gs,[a.star&&a.star>0?(n(),c("div",Js,[e("div",Ks,[(n(),c(E,null,z(5,l=>e("i",{key:l,class:N(l<=a.star?"fas fa-star":"far fa-star")},null,2)),64))]),e("span",Qs,b(a.star)+".0",1)])):(n(),c("div",Ws,Ys))]),e("div",Zs,[e("span",{class:N(a.is_enabled?"status-enabled":"status-disabled")},b(a.is_enabled?"已啟用":"未啟用"),3)])]),e("div",et,[e("button",{type:"button",class:"btn-edit",onClick:l=>C("edit",a)},[tt,R(" 編輯 ")],8,st),e("button",{type:"button",class:"btn-delete",onClick:l=>C("delete",a)},[at,R(" 刪除 ")],8,ot)])]))),128))]),e("div",lt,[S(ae,{pagination:w.value,onChangePage:s},null,8,["pagination"])]),S(Vs,{ref_key:"productModal",ref:k,"temp-product":v.value,"is-new":P.value,onUpdateProduct:A},null,8,["temp-product","is-new"]),S(te,{ref_key:"deleteModal",ref:M,item:v.value,onConfirm:O},null,8,["item"])],64)}}},pt=Q(it,[["__scopeId","data-v-bb37157a"]]);export{pt as default};
