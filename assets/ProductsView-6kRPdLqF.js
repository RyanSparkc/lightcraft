import{_ as L,a as T,h as v,r as p,o,c as i,d as l,b as e,w as y,n as g,F as h,i as b,t as r,e as _,j as f,p as S,f as q}from"./index-UKIsyGAy.js";import{u as I}from"./toastMessage-WJ0KJshq.js";import{u as V}from"./cartStore-OMo1VCRa.js";import{P as A}from"./PaginationComponent-zDNUzOVQ.js";import{H as E}from"./HeroSection-tvdwOl8V.js";var M={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"vue001",BASE_URL:"/lightcraft/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_URL:x,VITE_APP_PATH:k}=M,R={components:{PaginationComponent:A,HeroSection:E},data(){return{products:[],categories:[],isLoading:!0,isLoadingCart:null,pagination:{total_pages:1,current_page:1,has_pre:!1,has_next:!1}}},computed:{heroTitle(){return this.$route.query.category?`${this.$route.query.category} 系列`:"全部商品"}},watch:{"$route.query":{handler(){this.getProducts(1)}}},methods:{...T(I,["addMessage"]),getCategories(){v.get(`${x}/api/${k}/products/all`).then(s=>{const n=[...new Set(s.data.products.map(a=>a.category))];this.categories=n.filter(a=>a).map(a=>({name:a,icon:this.getCategoryIcon(a)}))}).catch(s=>{var n,a;this.addMessage({style:"danger",title:"錯誤",content:((a=(n=s.response)==null?void 0:n.data)==null?void 0:a.message)||"載入分類失敗"})})},getProducts(s=1){const{category:n=""}=this.$route.query;this.isLoading=!0,v.get(`${x}/api/${k}/products?category=${n}&page=${s}`).then(a=>{this.products=a.data.products,this.pagination=a.data.pagination,this.isLoading=!1}).catch(a=>{this.addMessage({style:"danger",title:"錯誤",content:a.response.data.message}),this.isLoading=!1})},changePage(s){s<1||s>this.pagination.total_pages||(this.getProducts(s),window.scrollTo({top:0,behavior:"smooth"}))},getCategoryIcon(s){return{智慧吊燈:"fas fa-lightbulb",智慧檯燈:"fas fa-desk-lamp",智慧燈泡:"fas fa-lightbulb",智慧燈具:"fas fa-home",氣氛燈光:"fas fa-star",戶外照明:"fas fa-moon",燈光配件:"fas fa-cog",室內照明:"fas fa-home",裝飾燈具:"fas fa-star",特殊用途:"fas fa-tools",衣服:"fas fa-tshirt",蛋糕:"fas fa-birthday-cake",食物:"fas fa-utensils",飲品:"fas fa-coffee",電子產品:"fas fa-laptop",家電:"fas fa-tv",書籍:"fas fa-book",玩具:"fas fa-gamepad",運動用品:"fas fa-basketball-ball",美妝:"fas fa-palette"}[s]||"fas fa-lightbulb text-warning"},async addToCart(s,n=1){this.isLoadingCart=s;const a=V();try{await a.addToCart(s,n)}finally{this.isLoadingCart=null}}},mounted(){this.getCategories(),this.getProducts()},beforeCreate(){this.$options.filters||(this.$options.filters={}),this.$options.filters.currency=function(n){return n?n.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):""}}},C=s=>(S("data-v-d2456fe6"),s=s(),q(),s),H={class:"products-view"},B={class:"container mt-md-5 mt-3 mb-7"},F={class:"row"},N={class:"col-lg-3 col-md-4"},O={class:"category-menu bg-light rounded p-4 mb-4"},z=C(()=>e("h5",{class:"mb-3 fw-bold"},"💡 產品分類",-1)),D={class:"list-unstyled"},U={class:"mb-2"},j={class:"col-lg-9 col-md-8"},G={class:"d-flex justify-content-between align-items-center mb-4"},J={class:"mb-0"},K={class:"text-muted"},Q={class:"row"},W={class:"card border-0 shadow-sm h-100 product-card"},X={class:"position-relative overflow-hidden"},Y=["src"],Z={key:0,class:"discount-badge position-absolute bg-danger text-white px-2 py-1 rounded",style:{left:"12px",top:"12px","font-size":"0.75rem","font-weight":"bold"}},tt={class:"card-body p-3 d-flex flex-column"},et={class:"card-title mb-2 fw-bold"},st={class:"product-specs mb-2 flex-grow-1"},at={key:0,class:"badge bg-light text-dark me-1 mb-1"},ot={key:1,class:"badge bg-secondary text-white me-1 mb-1"},it={key:0,class:"card-text text-muted small mb-2"},nt={class:"price-section mb-3"},rt={class:"d-flex align-items-center"},ct={class:"current-price h6 text-primary me-2 mb-0 fw-bold"},lt={key:0,class:"original-price text-muted text-decoration-line-through small"},dt={key:1,class:"rating mb-3"},gt={class:"d-flex align-items-center"},ht={class:"stars me-2"},_t={class:"text-muted small"},ft={key:2,class:"rating mb-3"},mt={class:"d-flex align-items-center"},ut={class:"stars me-2"},pt=C(()=>e("span",{class:"text-muted small"},"尚無評價",-1)),yt=["onClick","disabled"],bt={key:0,class:"fas fa-spinner fa-spin me-1"},vt={key:1,class:"fas fa-shopping-cart me-1"};function xt(s,n,a,kt,c,m){const w=p("LoadingOverlay"),P=p("HeroSection"),u=p("RouterLink"),$=p("PaginationComponent");return o(),i(h,null,[l(w,{active:c.isLoading},null,8,["active"]),e("div",H,[l(P,{title:m.heroTitle,subtitle:"探索精選商品，發現生活中的美好","icon-class":"bi bi-basket3"},null,8,["title"]),e("div",B,[e("div",F,[e("div",N,[e("div",O,[z,e("ul",D,[e("li",U,[l(u,{class:g(["category-link d-block py-2 px-3 rounded text-decoration-none",{"active bg-primary text-white":!s.$route.query.category,"text-dark":s.$route.query.category}]),to:"/products"},{default:y(()=>[_(" 🔍 全部商品 ")]),_:1},8,["class"])]),(o(!0),i(h,null,b(c.categories,t=>(o(),i("li",{class:"mb-2",key:t.name},[l(u,{class:g(["category-link d-block py-2 px-3 rounded text-decoration-none",{"active bg-primary text-white":s.$route.query.category===t.name,"text-dark":s.$route.query.category!==t.name}]),to:`/products?category=${t.name}`},{default:y(()=>[e("i",{class:g([t.icon,"me-2"])},null,2),_(r(t.name),1)]),_:2},1032,["to","class"])]))),128))])])]),e("div",j,[e("div",G,[e("h4",J,r(s.$route.query.category?`${s.$route.query.category} 系列`:"全部商品"),1),e("span",K,"共 "+r(c.products.length)+" 件商品",1)]),e("div",Q,[(o(!0),i(h,null,b(c.products,t=>(o(),i("div",{class:"col-xl-4 col-lg-6 col-md-6 mb-4",key:t.id},[e("div",W,[e("div",X,[l(u,{to:`/product/${t.id}`},{default:y(()=>[e("img",{src:t.imageUrl,class:"card-img-top product-image",height:"225",style:{"object-fit":"cover",transition:"transform 0.3s ease"},alt:"product.title"},null,8,Y)]),_:2},1032,["to"]),t.origin_price>t.price?(o(),i("span",Z,r(Math.round((1-t.price/t.origin_price)*100))+"% OFF ",1)):f("",!0)]),e("div",tt,[e("h6",et,[l(u,{to:`/product/${t.id}`,class:"text-decoration-none text-dark"},{default:y(()=>[_(r(t.title),1)]),_:2},1032,["to"])]),e("div",st,[t.category?(o(),i("span",at,[e("i",{class:g([m.getCategoryIcon(t.category),"me-1"])},null,2),_(" "+r(t.category),1)])):f("",!0),t.unit?(o(),i("span",ot,r(t.unit),1)):f("",!0)]),t.description?(o(),i("p",it,r(t.description.substring(0,50))+" "+r(t.description.length>50?"...":""),1)):f("",!0),e("div",nt,[e("div",rt,[e("span",ct," NT$"+r(s.$filters.currency(t.price)),1),t.origin_price>t.price?(o(),i("span",lt," NT$"+r(s.$filters.currency(t.origin_price)),1)):f("",!0)])]),t.star&&t.star>0?(o(),i("div",dt,[e("div",gt,[e("div",ht,[(o(),i(h,null,b(5,d=>e("i",{key:d,class:g(d<=t.star?"fas fa-star text-warning":"far fa-star text-muted"),style:{"font-size":"0.8rem"}},null,2)),64))]),e("span",_t,r(t.star)+".0 顆星",1)])])):(o(),i("div",ft,[e("div",mt,[e("div",ut,[(o(),i(h,null,b(5,d=>e("i",{key:d,class:"far fa-star text-muted",style:{"font-size":"0.8rem"}})),64))]),pt])])),e("button",{class:"btn btn-outline-primary btn-sm w-100 mt-auto",onClick:d=>m.addToCart(t.id),disabled:c.isLoadingCart===t.id},[c.isLoadingCart===t.id?(o(),i("i",bt)):(o(),i("i",vt)),_(" "+r(c.isLoadingCart===t.id?"加入中...":"加入購物車"),1)],8,yt)])])]))),128))]),l($,{pagination:c.pagination,"aria-label":"產品分頁",onChangePage:m.changePage},null,8,["pagination","onChangePage"])])])])])],64)}const Tt=L(R,[["render",xt],["__scopeId","data-v-d2456fe6"]]);export{Tt as default};
