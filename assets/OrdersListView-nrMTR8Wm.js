import{r as g,k as V,o as C,a as E,b as r,c as h,e as u,d as s,t as e,F as I,q as D,w as A,f as p,x as R,v as $,m as a,p as B,g as H,h as M}from"./index-AP1mULAj.js";import{P as j}from"./PaginationComponent-b-h3ghuo.js";import{H as U}from"./HeroSection-70C6suYV.js";import{_ as z}from"./plugin-vueexport-helper-x3n3nnut.js";var F={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"vue001",BASE_URL:"/lightcraft/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const t=v=>(B("data-v-07fb507e"),v=v(),H(),v),q={class:"orders-list-view"},W={class:"container-fluid px-4"},G={class:"statistics-dashboard mb-5"},J={class:"row g-4"},K={class:"col-lg-auto col-md-4 col-sm-6"},Q={class:"stat-card"},X=t(()=>s("div",{class:"stat-icon total"},[s("i",{class:"bi bi-list-check"})],-1)),Y={class:"stat-content"},Z={class:"stat-number"},ss=t(()=>s("p",{class:"stat-label"},"總訂單數",-1)),ts={class:"col-lg-auto col-md-4 col-sm-6"},os={class:"stat-card"},is=t(()=>s("div",{class:"stat-icon pending"},[s("i",{class:"bi bi-clock-history"})],-1)),cs={class:"stat-content"},es={class:"stat-number"},as=t(()=>s("p",{class:"stat-label"},"待付款",-1)),ns={class:"col-lg-auto col-md-4 col-sm-6"},ls={class:"stat-card"},ds=t(()=>s("div",{class:"stat-icon completed"},[s("i",{class:"bi bi-check-circle"})],-1)),_s={class:"stat-content"},rs={class:"stat-number"},hs=t(()=>s("p",{class:"stat-label"},"已完成",-1)),us={class:"col-lg-5 col-md-12 col-sm-6"},ps={class:"stat-card"},vs=t(()=>s("div",{class:"stat-icon amount"},[s("i",{class:"bi bi-currency-dollar"})],-1)),bs={class:"stat-content"},ms={class:"stat-number"},gs=t(()=>s("p",{class:"stat-label"},"累計金額",-1)),fs={class:"row"},ys={class:"col-12"},ks={key:0,class:"loading-container"},ws=M('<div class="loading-animation" data-v-07fb507e><div class="loading-spinner" data-v-07fb507e><div class="bounce1" data-v-07fb507e></div><div class="bounce2" data-v-07fb507e></div><div class="bounce3" data-v-07fb507e></div></div><h4 class="loading-text" data-v-07fb507e>正在載入您的訂單</h4><p class="loading-subtitle" data-v-07fb507e>請稍候片刻...</p></div>',1),As=[ws],xs={key:1,class:"orders-container"},Ps={class:"card border-0 shadow-sm"},Os={class:"card-body p-4"},Ts={class:"order-progress mb-4"},Ss=t(()=>s("div",{class:"step-icon"},[s("i",{class:"bi bi-bag-check"})],-1)),Ls=t(()=>s("span",{class:"step-label"},"訂單確認",-1)),Ns=[Ss,Ls],Vs=t(()=>s("div",{class:"step-icon"},[s("i",{class:"bi bi-credit-card"})],-1)),Cs=t(()=>s("span",{class:"step-label"},"付款完成",-1)),Es=[Vs,Cs],Is=t(()=>s("div",{class:"step-icon"},[s("i",{class:"bi bi-truck"})],-1)),Ds=t(()=>s("span",{class:"step-label"},"配送中",-1)),Rs=[Is,Ds],$s=t(()=>s("div",{class:"step-icon"},[s("i",{class:"bi bi-house-check"})],-1)),Bs=t(()=>s("span",{class:"step-label"},"已送達",-1)),Hs=[$s,Bs],Ms={class:"row align-items-center g-3"},js={class:"col-lg-2 col-md-3 col-sm-6"},Us={class:"order-info-item"},zs=t(()=>s("div",{class:"info-icon"},[s("i",{class:"bi bi-hash"})],-1)),Fs={class:"info-content"},qs=t(()=>s("h6",{class:"info-label"},"訂單編號",-1)),Ws={class:"info-value"},Gs={class:"col-lg-2 col-md-3 col-sm-6"},Js={class:"order-info-item"},Ks=t(()=>s("div",{class:"info-icon"},[s("i",{class:"bi bi-calendar3"})],-1)),Qs={class:"info-content"},Xs=t(()=>s("h6",{class:"info-label"},"訂單日期",-1)),Ys={class:"info-value"},Zs={class:"col-lg-2 col-md-3 col-sm-6"},st={class:"order-info-item"},tt=t(()=>s("div",{class:"info-icon"},[s("i",{class:"bi bi-credit-card"})],-1)),ot={class:"info-content"},it=t(()=>s("h6",{class:"info-label"},"付款狀態",-1)),ct={class:"col-lg-2 col-md-3 col-sm-6"},et={class:"order-info-item"},at=t(()=>s("div",{class:"info-icon"},[s("i",{class:"bi bi-box-seam"})],-1)),nt={class:"info-content"},lt=t(()=>s("h6",{class:"info-label"},"商品數量",-1)),dt={class:"info-value"},_t={class:"col-lg-2 col-md-6 col-sm-6"},rt={class:"order-info-item"},ht=t(()=>s("div",{class:"info-icon total-icon"},[s("i",{class:"bi bi-currency-dollar"})],-1)),ut={class:"info-content"},pt=t(()=>s("h6",{class:"info-label"},"訂單總額",-1)),vt={class:"info-value total-amount"},bt={class:"col-lg-2 col-md-6 col-sm-6"},mt={class:"order-actions"},gt=t(()=>s("i",{class:"bi bi-eye me-1"},null,-1)),ft={key:2,class:"empty-state"},yt={class:"empty-illustration"},kt=t(()=>s("div",{class:"empty-icon"},[s("i",{class:"bi bi-bag-x"})],-1)),wt={class:"empty-content"},At=t(()=>s("h3",{class:"empty-title"},"還沒有任何訂單",-1)),xt=t(()=>s("p",{class:"empty-subtitle"}," 快去探索我們精選的商品，開始您的購物之旅吧！ ",-1)),Pt={class:"empty-actions"},Ot=t(()=>s("i",{class:"bi bi-bag-plus me-2"},null,-1)),Tt=t(()=>s("i",{class:"bi bi-house me-2"},null,-1)),St={key:3,class:"error-state"},Lt=t(()=>s("div",{class:"error-icon"},[s("i",{class:"bi bi-exclamation-triangle"})],-1)),Nt=t(()=>s("h4",{class:"error-title"},"載入失敗",-1)),Vt={class:"error-message"},Ct=t(()=>s("i",{class:"bi bi-arrow-clockwise me-2"},null,-1)),Et={__name:"OrdersListView",setup(v){const d=g([]),f=g({total_pages:1,current_page:1,has_pre:!1,has_next:!1}),y=g(!1),b=g(null),x=o=>{if(!o.products)return Number(o.total||0);const c=Array.isArray(o.products)?o.products:Object.values(o.products);if(c.some(i=>i.coupon)){const i=c.reduce((_,w)=>_+Number(w.total||0),0),l=Number(o.total||0);return i-l}return Number(o.total||0)},m=V(()=>{const o=d.value.length,c=d.value.filter(l=>!l.is_paid).length,n=d.value.filter(l=>l.is_paid).length,i=d.value.reduce((l,_)=>{const w=x(_);return l+w},0);return{totalOrders:o,pendingOrders:c,completedOrders:n,totalAmount:Math.round(i).toLocaleString()}}),k=async(o=1)=>{var c,n;try{y.value=!0,b.value=null;const{VITE_APP_URL:i,VITE_APP_PATH:l}=F,_=await $.get(`${i}/api/${l}/orders?page=${o}`);if(_.data.success)d.value=_.data.orders,f.value=_.data.pagination;else throw new Error("獲取訂單列表失敗")}catch(i){b.value=((n=(c=i.response)==null?void 0:c.data)==null?void 0:n.message)||i.message||"獲取訂單列表失敗"}finally{y.value=!1}},P=o=>{o>=1&&o<=f.value.total_pages&&(k(o),window.scrollTo({top:0,behavior:"smooth"}))},O=o=>o?new Date(o*1e3).toLocaleDateString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"",T=o=>o.products?Array.isArray(o.products)?o.products.length:typeof o.products=="object"?Object.keys(o.products).length:0:0,S=o=>{const c=x(o);return Math.round(c).toLocaleString()},L=o=>o.is_paid?"completed":"pending",N=o=>o.is_paid?"已完成":"處理中";return C(()=>{k()}),(o,c)=>{const n=E("RouterLink");return r(),h("div",q,[u(U,{title:"我的訂單",subtitle:"管理您的所有訂單，追蹤購買記錄","icon-class":"bi bi-receipt-cutoff"}),s("div",W,[s("div",G,[s("div",J,[s("div",K,[s("div",Q,[X,s("div",Y,[s("h3",Z,e(m.value.totalOrders),1),ss])])]),s("div",ts,[s("div",os,[is,s("div",cs,[s("h3",es,e(m.value.pendingOrders),1),as])])]),s("div",ns,[s("div",ls,[ds,s("div",_s,[s("h3",rs,e(m.value.completedOrders),1),hs])])]),s("div",us,[s("div",ps,[vs,s("div",bs,[s("h3",ms,"NT$ "+e(m.value.totalAmount),1),gs])])])])]),s("div",fs,[s("div",ys,[y.value?(r(),h("div",ks,As)):d.value.length>0?(r(),h("div",xs,[(r(!0),h(I,null,D(d.value,i=>(r(),h("div",{key:i.id,class:"order-card mb-4"},[s("div",Ps,[s("div",{class:a(["order-status-ribbon",L(i)])},[s("span",null,e(N(i)),1)],2),s("div",Os,[s("div",Ts,[s("div",{class:a(["progress-step",{active:!0}])},Ns),s("div",{class:a(["progress-line",{active:i.is_paid}])},null,2),s("div",{class:a(["progress-step",{active:i.is_paid}])},Es,2),s("div",{class:a(["progress-line",{active:i.is_paid}])},null,2),s("div",{class:a(["progress-step",{active:i.is_paid}])},Rs,2),s("div",{class:a(["progress-line",{active:i.is_paid}])},null,2),s("div",{class:a(["progress-step",{active:i.is_paid}])},Hs,2)]),s("div",Ms,[s("div",js,[s("div",Us,[zs,s("div",Fs,[qs,s("p",Ws,e(i.id.substring(0,8))+"... ",1)])])]),s("div",Gs,[s("div",Js,[Ks,s("div",Qs,[Xs,s("p",Ys,e(O(i.create_at)),1)])])]),s("div",Zs,[s("div",st,[tt,s("div",ot,[it,s("span",{class:a(["payment-badge",i.is_paid?"paid":"unpaid"])},[s("i",{class:a(i.is_paid?"bi bi-check-circle":"bi bi-exclamation-circle")},null,2),p(" "+e(i.is_paid?"已付款":"待付款"),1)],2)])])]),s("div",ct,[s("div",et,[at,s("div",nt,[lt,s("p",dt,e(T(i))+" 項 ",1)])])]),s("div",_t,[s("div",rt,[ht,s("div",ut,[pt,s("p",vt," NT$ "+e(S(i)),1)])])]),s("div",bt,[s("div",mt,[u(n,{to:`/order/${i.id}`,class:"btn btn-primary btn-sm"},{default:A(()=>[gt,p(" 查看詳情 ")]),_:2},1032,["to"])])])])])])]))),128)),u(j,{pagination:f.value,"aria-label":"訂單分頁",onChangePage:P},null,8,["pagination"])])):(r(),h("div",ft,[s("div",yt,[kt,s("div",wt,[At,xt,s("div",Pt,[u(n,{to:"/products",class:"btn btn-primary btn-lg"},{default:A(()=>[Ot,p(" 開始購物 ")]),_:1}),u(n,{to:"/",class:"btn btn-outline-primary btn-lg ms-3"},{default:A(()=>[Tt,p(" 回到首頁 ")]),_:1})])])])])),b.value?(r(),h("div",St,[Lt,Nt,s("p",Vt,e(b.value),1),s("button",{class:"btn btn-primary",onClick:k},[Ct,p(" 重新載入 ")])])):R("",!0)])])])])}}},Bt=z(Et,[["__scopeId","data-v-07fb507e"]]);export{Bt as default};
